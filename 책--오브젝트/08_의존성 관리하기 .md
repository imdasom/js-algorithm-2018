## 02 유연한 설계
의존성을 관리하는데 유용한 몇가지 원칙과 기법을 익힐 필요가 있다
### 의존성과 결합도
- 누구와 의존하느냐도 중요하지만, 의존성의 정도도 중요하다
- 구체적인 클래스와 의존하는 것보다, 추상화된 인터페이스와 의존하는 것이 좋을수도 있다
- 비슷한 다른 환경에서도 같은 의존관계를 사용할수있다면 바람직한 의존관계라고 볼수있다
- 바람직한 의존관계 = 느슨한 결합도 loose coupling = 약한 결합도 weak coupling
- 의존하는 클래스에 대해 자세히 알수록 결합도가 높아진다
- 결합도를 느슨하게 하기 위해선 --> 추상화를 해야 한다

### 추상화에 의존하라
- 추상화는 특정절차나 데이터를 의도적으로 감춤으로써 복잡도를 낮출수있다

### new는 해롭다
- 클래스 내부에서 new를 통해 생성하게 되면
    - 인터페이스가 아닌 구체적인 클래스에 의존하게 된다
    - 생성자에 딸린 다른 의존성도 같이 가지게 된다.
- new를 안쓸수는 없다. 그럼 어떻게? --> 인스턴스를 생성하는 로직과 사용하는 로직을 분리하면 된다
- 그럼 new는 누가 하나? --> 상위로 올라가서, 혹은 클라이언트에서 생성하여 주입한다. 혹은 factory 패턴을 사용할수도 있겠다. spring은 autowired를 사용

### new는 해롭지만 사용하는 경우도 있다
- A구체클래스와 B구체클래스가 있을때, 대부분 A구체클래스를 생성해서 사용하고, B는 가끔 사용할때
- 클라이언트단에서 불필요한 중복코드가 발생할 수 있다
- 그럼 어떻게 해결? --> 기본생성자를 호출하는 생성자를 추가해서 사용한다
- 결합도가 올라가지만, 클라이언트단의 사용성은 증가한다. 트레이드 오프!
```java
// 기본생성자를 호출하는 생성자를 추가해준다
public Movie(String title, Durtaion runningTime) {
  this(title, runningTime, fee, new AmountDiscountPolicy(...));
}

// 기본생성자
public Movie(String title, Duration runningTime, Money fee, DiscountPolicy discountPolicy) {
  ...
  this.discountPolicy = discountPolicy;
}
```
